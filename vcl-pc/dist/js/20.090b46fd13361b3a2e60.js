webpackJsonp([20],{"6J3t":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Xxa5"),i=s.n(a),r=s("exGp"),n=s.n(r),c=s("UuhT"),l={name:"message_receive",data:function(){return{searchText:"",pageSize:10,currentPage:1,total:0,messageList:[],visible:!1}},methods:{getSendMessage:function(e,t){var s=this;return n()(i.a.mark(function a(){var r,n;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r={keyword:"send",userId:s.$store.state.user.id,perpage:e,currentPage:t,type:1},a.next=3,Object(c.d)(r);case 3:"SUCCESS"===(n=a.sent).data.mitiStatus?(s.total=n.data.entity.total,s.messageList=n.data.entity.data):s.$message.error("ERROR: "+n.data.message);case 5:case"end":return a.stop()}},a,s)}))()},messageAllClear:function(){var e=this;return n()(i.a.mark(function t(){var s,a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s={userId:e.$store.state.user.id,keyword:"send",type:1},t.next=3,Object(c.b)(s);case 3:"SUCCESS"===(a=t.sent).data.mitiStatus?(e.$message.success(a.data.entity),e.getSendMessage(e.pageSize,e.currentPage)):e.$message.error("ERROR: "+a.data.message);case 5:case"end":return t.stop()}},t,e)}))()},searchMessage:function(){var e=this;return n()(i.a.mark(function t(){var s,a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s={userId:e.$store.state.user.id,searchText:e.searchText,keyword:"send",perPage:e.pageSize,currentPage:e.currentPage,type:1},t.next=3,Object(c.c)(s);case 3:"SUCCESS"===(a=t.sent).data.mitiStatus?(e.total=a.data.entity.total,e.messageList=a.data.entity.data):e.$message.error("ERROR: "+a.data.message);case 5:case"end":return t.stop()}},t,e)}))()},search:function(e){var t=this;return n()(i.a.mark(function s(){var a,r;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a={mode:e,userId:t.$store.state.user.id,like:t.searchText,keyword:"send",perPage:t.pageSize,currentPage:1,type:1},s.next=3,Object(c.c)(a);case 3:"SUCCESS"===(r=s.sent).data.mitiStatus?(t.total=r.data.entity.total,t.messageList=r.data.entity.data,console.log(r.data.entity.data)):t.$message.error("ERROR: "+r.data.message);case 5:case"end":return s.stop()}},s,t)}))()},deleteSingle:function(e){var t=this;return n()(i.a.mark(function s(){var a,r;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a={mailId:e.id,messageType:"send"},s.next=3,Object(c.e)(a);case 3:"SUCCESS"===(r=s.sent).data.mitiStatus?(t.$message.success(r.data.entity),t.getSendMessage(t.pageSize,t.currentPage)):t.$message.error("ERROR: "+r.data.message);case 5:case"end":return s.stop()}},s,t)}))()},SizeChange:function(e){this.pageSize=e,this.getSendMessage(this.pageSize,this.currentPage)},changePage:function(e){this.currentPage=e,this.getSendMessage(this.pageSize,this.currentPage)}},mounted:function(){this.getSendMessage(this.pageSize,this.currentPage)},watch:{searchText:{handler:function(e){this.visible=""!==e},deep:!0}}},o={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"send"}},[s("div",{staticClass:"top-nav"},[s("div",{staticStyle:{"margin-right":"20px"}},[s("el-button",{attrs:{type:"primary"},on:{click:e.messageAllClear}},[s("i",{staticClass:"ercp-icon-general-clean"}),e._v("全部清空")])],1),e._v(" "),s("el-popover",{attrs:{placement:"bottom-start",width:"225",trigger:"manual"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[s("div",{staticClass:"select-type",staticStyle:{"line-height":"36px",cursor:"pointer",transform:"scale(1.1, 1.2)","font-size":"12px","text-align":"center"}},[s("div",{staticClass:"hover-bgc",staticStyle:{width:"100%",padding:"0 10px","box-sizing":"border-box",height:"36px"},on:{click:function(t){e.search("title")}}},[s("span",{staticClass:"float-left"},[e._v("搜索主题包含")]),e._v(" "),s("div",{staticClass:"text-overflow-ellipsis",staticStyle:{width:"90px",float:"left",padding:"0 2px"}},[s("b",[e._v("「 "+e._s(e.searchText)+" 」")])]),e._v(" "),s("span",{staticClass:"float-left"},[e._v("的消息")])]),e._v(" "),s("div",{staticClass:"hover-bgc",staticStyle:{width:"100%",padding:"0 10px","box-sizing":"border-box",height:"36px"},on:{click:function(t){e.search("message")}}},[s("span",{staticClass:"float-left"},[e._v("搜索正文包含")]),e._v(" "),s("div",{staticClass:"text-overflow-ellipsis",staticStyle:{width:"90px",float:"left",padding:"0 2px"}},[s("b",[e._v("「 "+e._s(e.searchText)+" 」")])]),e._v(" "),s("span",{staticClass:"float-left"},[e._v("的消息")])]),e._v(" "),s("div",{staticClass:"hover-bgc",staticStyle:{width:"100%",padding:"0 10px","box-sizing":"border-box",height:"36px"},on:{click:function(t){e.search("receiver")}}},[s("span",{staticClass:"float-left"},[e._v("搜索收件人为")]),e._v(" "),s("div",{staticClass:"text-overflow-ellipsis",staticStyle:{width:"90px",float:"left",padding:"0 2px"}},[s("b",[e._v("「 "+e._s(e.searchText)+" 」")])]),e._v(" "),s("span",{staticClass:"float-left"},[e._v("的消息")])])]),e._v(" "),s("el-input",{staticStyle:{width:"251px"},attrs:{slot:"reference",placeholder:"搜索信息",clearable:""},slot:"reference",model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}},[s("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{cursor:"pointer"},attrs:{slot:"prefix"},slot:"prefix"})])],1)],1),e._v(" "),s("div",{staticClass:"message-list"},[s("div",{staticClass:"message-box"},[e._m(0),e._v(" "),0===e.messageList.length?s("div",{staticClass:"no-message light-text"},[e._v("\n        暂无消息\n      ")]):e._e(),e._v(" "),s("el-collapse",{attrs:{accordion:""}},e._l(e.messageList,function(t,a){return s("el-collapse-item",{key:a,staticStyle:{position:"relative"}},[s("div",{staticClass:"message-case",attrs:{slot:"title"},slot:"title"},[s("div",{staticClass:"message-title"},[s("div",{staticClass:"sender text-overflow-ellipsis"},[s("span",{class:{"primary-text":1===t.status}},[e._v(e._s(null===t.receiveUser?"":t.receiveUser.name))])])]),e._v(" "),s("div",{staticClass:"message-content"},[s("div",{staticClass:"theme"},[e._v(e._s(t.title))]),e._v(" "),s("div",{staticClass:"content light-text"},[e._v("- "+e._s(t.message))])]),e._v(" "),s("div",{staticClass:"send-time"},[s("div",{staticClass:"date"},[e._v("20"+e._s(t.sendTime))])]),e._v(" "),s("div",{staticClass:"operate"},[s("div",{staticClass:"inside"},[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除消息",placement:"top"}},[s("i",{staticClass:"ercp-icon-general-remove danger-text",on:{click:function(s){s.stopPropagation(),e.deleteSingle(t)}}})])],1)])]),e._v(" "),s("div",{staticClass:"message-view"},[s("b",[e._v("消息正文：")]),s("span",{staticClass:"light-text"},[e._v(e._s(t.message))])])])}))],1)]),e._v(" "),s("div",{staticClass:"pagination align-right"},[s("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-sizes":[5,10,15],total:e.total,"current-page":e.currentPage,"page-size":e.pageSize},on:{"size-change":e.SizeChange,"current-change":e.changePage}})],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"message-box-title"},[t("div",{staticClass:"sender-title"},[this._v("收件人")]),this._v(" "),t("div",{staticClass:"theme-title"},[this._v("主题 - 正文")]),this._v(" "),t("div",{staticClass:"sendtime-title"},[this._v("时间")]),this._v(" "),t("div",{staticClass:"operate-title"},[this._v("操作")])])}]};var d=s("VU/8")(l,o,!1,function(e){s("cEuf")},"data-v-838c9306",null);t.default=d.exports},cEuf:function(e,t){}});